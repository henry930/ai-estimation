(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{3515:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var l=t(5155),r=t(2115),i=t(6489),n=t(1920),a=t(9538),c=t(2619),o=t.n(c);function d(e){let{onConnectGitHub:s}=e;return(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)(o(),{href:"/estimate/new",className:"flex flex-col items-center justify-center p-6 bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl hover:from-blue-500 hover:to-blue-600 transition-all shadow-lg shadow-blue-900/20 group",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center mb-3 group-hover:bg-white/30 transition-colors text-white",children:(0,l.jsx)(u,{})}),(0,l.jsx)("span",{className:"font-semibold text-white",children:"New Estimation"})]}),(0,l.jsxs)("button",{className:"flex flex-col items-center justify-center p-6 bg-[#111] border border-white/10 rounded-2xl hover:bg-white/5 transition-all text-gray-300 hover:text-white group",onClick:s,children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center mb-3 group-hover:bg-white/10 transition-colors",children:(0,l.jsx)(h,{})}),(0,l.jsx)("span",{className:"font-medium",children:"Connect GitHub"})]})]})}function u(){return(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}function h(){return(0,l.jsx)("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",fill:"currentColor",children:(0,l.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})}function x(){let[e,s]=(0,r.useState)(null),[t,i]=(0,r.useState)(!0),[n,a]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),u=async()=>{try{let e=await fetch("/api/subscription/status");if(!e.ok)throw Error("Failed to fetch subscription status");let t=await e.json();s(t.subscription)}catch(e){a(e.message)}finally{i(!1)}};(0,r.useEffect)(()=>{u()},[]);let h=async()=>{if(window.confirm("Are you sure you want to cancel your subscription? You will lose access to Pro features.")){d(!0);try{let e=await fetch("/api/subscription/cancel",{method:"POST"});if(e.ok)alert("Subscription cancelled successfully."),u();else{let s=await e.json();alert(s.error||"Failed to cancel subscription.")}}catch(e){alert("Failed to cancel subscription.")}finally{d(!1)}}};if(t)return(0,l.jsxs)("div",{className:"bg-[#111] rounded-2xl p-6 border border-white/10 animate-pulse",children:[(0,l.jsx)("div",{className:"h-6 w-32 bg-white/5 rounded mb-6"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"h-4 w-full bg-white/5 rounded"}),(0,l.jsx)("div",{className:"h-2 w-full bg-white/5 rounded"})]})]});if(n||!e)return(0,l.jsx)("div",{className:"bg-[#111] rounded-2xl p-6 border border-white/10",children:(0,l.jsx)("p",{className:"text-red-400 text-sm",children:"Failed to load subscription status."})});let x=e.limit>0?Math.min(e.usage/e.limit*100,100):0;return(0,l.jsxs)("div",{className:"bg-[#111] rounded-2xl p-6 border border-white/10",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold text-lg",children:"Subscription"}),(0,l.jsxs)("span",{className:"px-3 py-1 bg-white/10 rounded-full text-xs font-medium",children:[e.planName," Plan"]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,l.jsx)("span",{className:"text-gray-400",children:"Monthly Usage"}),(0,l.jsxs)("span",{className:"text-white font-medium",children:[e.usage," / ",-1===e.limit?"âˆž":e.limit," estimations"]})]}),-1!==e.limit&&(0,l.jsx)("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all duration-500",style:{width:"".concat(x,"%")}})})]}),(0,l.jsxs)("div",{className:"pt-4 border-t border-white/5",children:[e.renewsAt&&(0,l.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Renews on ",new Date(e.renewsAt).toLocaleDateString()]}),"free"===e.plan?(0,l.jsx)(o(),{href:"/pricing",className:"block w-full py-2 bg-white text-black rounded-lg text-sm text-center font-semibold hover:bg-gray-200 transition-colors",children:"Upgrade to Pro"}):(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("button",{onClick:h,disabled:c,className:"block w-full py-2 bg-red-500/10 text-red-500 rounded-lg text-sm text-center font-semibold hover:bg-red-500/20 transition-colors disabled:opacity-50",children:c?"Cancelling...":"Cancel Subscription"}),(0,l.jsx)("p",{className:"text-[10px] text-gray-600 text-center uppercase tracking-widest font-bold",children:"Pro Member"})]})]})]})]})}var m=t(9936);function b(){var e,s;let{data:t}=(0,i.useSession)(),[c,o]=(0,r.useState)(!1),[u,h]=(0,r.useState)(0);return(0,l.jsxs)(n.default,{rightSidebar:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d,{onConnectGitHub:()=>o(!0)}),(0,l.jsx)(x,{})]}),children:[(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-3xl font-bold",children:["Welcome back, ",(null==t||null==(s=t.user)||null==(e=s.name)?void 0:e.split(" ")[0])||"User"]}),(0,l.jsx)("p",{className:"text-gray-400 mt-1",children:"Here's what's happening with your projects."})]})}),(0,l.jsx)("div",{className:"space-y-8",children:(0,l.jsx)(a.A,{onConnectClick:()=>o(!0)},u)})]}),c&&(0,l.jsx)(m.A,{onProjectCreated:()=>{h(e=>e+1)},onClose:()=>o(!1)})]})}},4842:(e,s,t)=>{Promise.resolve().then(t.bind(t,3515))}},e=>{e.O(0,[6489,2619,7119,1620,8441,1255,7358],()=>e(e.s=4842)),_N_E=e.O()}]);